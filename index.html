<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <title>TeacherPro v4.8 - Fixed & Complete</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <style>
        :root { --p: #5c7a63; --bg: #fdfcf8; --c: #fff; --b: rgba(0,0,0,0.1); }
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body { font-family: system-ui, sans-serif; background: var(--bg); margin: 0; display: flex; height: 100vh; overflow: hidden; }
        
        /* NAVIGATION ENGINE CSS */
        .view { display: none; width: 100%; height: 100%; overflow-y: auto; padding: 20px; }
        .active-view { display: block !important; }

        .sidebar { width: 250px; background: #f4f1ea; border-right: 1px solid var(--b); display: flex; flex-direction: column; padding: 20px; }
        .nav-btn { padding: 15px; margin-bottom: 5px; border-radius: 12px; cursor: pointer; font-weight: bold; background: transparent; border: none; text-align: left; width: 100%; display: flex; gap: 10px; }
        .nav-btn.active { background: var(--p); color: white; }

        @media (max-width: 800px) {
            body { flex-direction: column; }
            .sidebar { width: 100%; height: 70px; flex-direction: row; order: 2; padding: 5px; border-top: 1px solid var(--b); justify-content: space-around; }
            .nav-btn { flex-direction: column; font-size: 0.65rem; align-items: center; padding: 5px; }
            .main { order: 1; height: calc(100vh - 70px); }
        }

        .main { flex: 1; display: flex; flex-direction: column; }
        .card { background: var(--c); border-radius: 15px; padding: 20px; border: 1px solid var(--b); margin-bottom: 20px; box-shadow: 0 2px 10px rgba(0,0,0,0.05); }
        
        table { width: 100%; border-collapse: collapse; }
        th, td { border: 1px solid var(--b); padding: 8px; text-align: center; }
        th { background: var(--p); color: white; font-size: 0.8rem; }
        input { width: 100%; border: none; background: transparent; text-align: center; }

        #auth { position: fixed; inset: 0; background: var(--bg); z-index: 9999; display: flex; align-items: center; justify-content: center; }
    </style>
</head>
<body>

<div id="auth">
    <div style="background:white; padding:30px; border-radius:20px; text-align:center; width:300px; border:1px solid var(--b)">
        <h2 style="color:var(--p)">TeacherPro Login</h2>
        <div id="setup-msg"></div>
        <input type="password" id="pw" placeholder="Passwort" style="padding:10px; width:100%; margin-bottom:10px; border-radius:8px; border:1px solid var(--b)">
        <button onclick="login()" style="width:100%; padding:10px; background:var(--p); color:white; border:none; border-radius:8px; font-weight:bold">Starten</button>
    </div>
</div>

<nav class="sidebar">
    <div style="font-weight:900; color:var(--p); margin-bottom:20px" class="hidden-mobile">TeacherPro v4.8</div>
    <button class="nav-btn active" onclick="show('dash', this)"><span>üè† √úbersicht</span></button>
    <button class="nav-btn" onclick="show('plan', this)"><span>üìÖ Stundenplan</span></button>
    <button class="nav-btn" onclick="show('cls', this)"><span>üë• Klassen</span></button>
    <button class="nav-btn" onclick="show('tmr', this)"><span>‚è±Ô∏è Timer</span></button>
</nav>

<main class="main">
    <div id="dash" class="view active-view">
        <div class="card" style="background:var(--p); color:white"><h2>Dashboard</h2><p id="welcome"></p></div>
        <div class="card"><h3>Notizen</h3><textarea id="notes" style="width:100%; height:150px; border:1px solid var(--b)" oninput="save()"></textarea></div>
    </div>

    <div id="plan" class="view">
        <div class="card">
            <h3>Wochenplan</h3>
            <table>
                <tr><th>Std</th><th>Mo</th><th>Di</th><th>Mi</th><th>Do</th><th>Fr</th></tr>
                <tbody id="plan-body"></tbody>
            </table>
        </div>
    </div>

    <div id="cls" class="view">
        <div class="card">
            <button onclick="addCls()">+ Neue Klasse</button>
            <div id="cls-list" style="margin-top:15px"></div>
        </div>
    </div>

    <div id="tmr" class="view">
        <div class="card" style="text-align:center">
            <h1 id="tdisp" style="font-size:4rem">25:00</h1>
            <button onclick="startT()">Timer starten</button>
        </div>
    </div>
</main>

<script>
    let db = { name: 'Lehrkraft', pw: '1234', notes: '', classes: [], schedule: {} };

    window.onload = () => {
        const s = localStorage.getItem('tp_v48_final');
        if(s) db = JSON.parse(s);
        else document.getElementById('setup-msg').innerHTML = "<p small>Erster Start: Passwort ist '1234'</p>";
        
        // Plan bauen
        const b = document.getElementById('plan-body');
        for(let i=1; i<=6; i++) {
            let r = `<tr><td>${i}</td>`;
            for(let j=1; j<=5; j++) r += `<td><input id="p-${i}-${j}" oninput="saveP()" value="${db.schedule[i+'-'+j] || ''}"></td>`;
            b.innerHTML += r + `</tr>`;
        }
    };

    function login() {
        const p = document.getElementById('pw').value;
        if(p === db.pw) {
            document.getElementById('auth').style.display = 'none';
            document.getElementById('welcome').innerText = "Willkommen zur√ºck!";
            document.getElementById('notes').value = db.notes;
            renderC();
        } else alert("Falsch!");
    }

    function show(id, btn) {
        document.querySelectorAll('.view').forEach(v => v.classList.remove('active-view'));
        document.getElementById(id).classList.add('active-view');
        document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
    }

    function save() { db.notes = document.getElementById('notes').value; localStorage.setItem('tp_v48_final', JSON.stringify(db)); }
    function saveP() { for(let i=1;i<=6;i++){for(let j=1;j<=5;j++){db.schedule[i+'-'+j]=document.getElementById('p-'+i+'-'+j).value;}} save(); }
    function addCls() { const n=prompt("Klasse:"); if(n){db.classes.push(n);save();renderC();}}
    function renderC() { const l=document.getElementById('cls-list'); l.innerHTML=''; db.classes.forEach(c=>l.innerHTML+=`<div class="card">${c}</div>`); }
    function startT() { let s=1500; setInterval(()=>{s--; document.getElementById('tdisp').innerText=Math.floor(s/60)+":"+(s%60<10?'0':'')+(s%60);},1000); }
</script>
</body>
</html>
