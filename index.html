<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <title>TeacherPro v4.5 Luxe - Fixed Edition</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

    <style>
        :root {
            --bg-body: #f8f7f2;
            --bg-sidebar: rgba(244, 241, 234, 0.9);
            --bg-card: #ffffff;
            --primary: #5c7a63; 
            --primary-light: #e8f0ea;
            --text-main: #2c3e50;
            --text-muted: #7f8c8d;
            --border: rgba(92, 122, 99, 0.15);
            --danger: #e74c3c;
            --radius: 20px;
            --shadow: 0 8px 30px rgba(0,0,0,0.05);
            --font-main: 'SF Pro Display', system-ui, sans-serif;
        }

        body.dark-theme {
            --bg-body: #121212;
            --bg-sidebar: #1c1c1e;
            --bg-card: #2c2c2e;
            --text-main: #f2f2f7;
            --border: rgba(255, 255, 255, 0.1);
        }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body { font-family: var(--font-main); background: var(--bg-body); color: var(--text-main); margin: 0; display: flex; height: 100vh; overflow: hidden; }

        /* WICHTIG: Versteckt inaktive Reiter */
        .hidden { display: none !important; }

        /* AUTH */
        #auth-overlay { position: fixed; inset: 0; background: var(--bg-body); z-index: 9999; display: flex; align-items: center; justify-content: center; backdrop-filter: blur(20px); }
        .auth-card { background: var(--bg-card); padding: 40px; border-radius: 30px; width: 90%; max-width: 380px; box-shadow: var(--shadow); border: 1px solid var(--border); text-align: center; }

        /* NAV */
        .sidebar { width: 260px; background: var(--bg-sidebar); border-right: 1px solid var(--border); display: flex; flex-direction: column; padding: 30px 15px; }
        .nav-item { display: flex; align-items: center; gap: 12px; padding: 14px 18px; margin-bottom: 5px; border-radius: 15px; cursor: pointer; transition: 0.3s; font-weight: 500; }
        .nav-item:hover { background: var(--primary-light); color: var(--primary); }
        .nav-item.active { background: var(--primary); color: white; }

        @media (max-width: 850px) {
            body { flex-direction: column; }
            .sidebar { width: 100%; height: 80px; flex-direction: row; order: 2; padding: 0; border-right: none; border-top: 1px solid var(--border); justify-content: space-around; }
            .nav-item { flex-direction: column; font-size: 0.7rem; gap: 4px; padding: 10px; }
            .main { order: 1; height: calc(100vh - 80px); }
        }

        .main { flex: 1; display: flex; flex-direction: column; overflow: hidden; }
        .header { height: 80px; display: flex; align-items: center; justify-content: space-between; padding: 0 30px; }
        .content { flex: 1; padding: 20px 30px; overflow-y: auto; }

        .card { background: var(--bg-card); border-radius: var(--radius); padding: 25px; border: 1px solid var(--border); box-shadow: var(--shadow); margin-bottom: 20px; }
        input, select, textarea { width: 100%; padding: 12px; border: 1px solid var(--border); border-radius: 12px; background: #fff; margin-bottom: 15px; font-size: 1rem; }
        button { background: var(--primary); color: white; border: none; padding: 12px 20px; border-radius: 12px; font-weight: 600; cursor: pointer; transition: 0.2s; }
        
        .icon { width: 20px; height: 20px; stroke: currentColor; fill: none; stroke-width: 2; }
    </style>
</head>
<body>

    <div id="auth-overlay">
        <div class="auth-card">
            <h1 style="color: var(--primary); margin: 0;">TeacherPro</h1>
            <p style="color: var(--text-muted); margin-bottom: 25px;">Sicherer Login</p>
            <div id="reg-box"><input type="text" id="reg-name" placeholder="Name"></div>
            <input type="password" id="auth-pass" placeholder="Passwort">
            <button onclick="handleAuth()" style="width: 100%;">Anmelden ðŸŒ¿</button>
        </div>
    </div>

    <nav class="sidebar">
        <div style="font-weight: 800; color: var(--primary); padding: 0 15px 30px; font-size: 1.4rem;" class="hidden-mobile">TeacherPro</div>
        <div class="nav-item active" onclick="nav('dashboard')"><svg class="icon" viewBox="0 0 24 24"><rect x="3" y="3" width="7" height="7"></rect><rect x="14" y="3" width="7" height="7"></rect><rect x="14" y="14" width="7" height="7"></rect><rect x="3" y="14" width="7" height="7"></rect></svg><span>Dashboard</span></div>
        <div class="nav-item" onclick="nav('classes')"><svg class="icon" viewBox="0 0 24 24"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path><circle cx="9" cy="7" r="4"></circle></svg><span>Klassen</span></div>
        <div class="nav-item" onclick="nav('tools')"><svg class="icon" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg><span>Tools</span></div>
        <div style="flex:1"></div>
        <div class="nav-item" onclick="toggleTheme()"><span>ðŸŒ“ Design</span></div>
    </nav>

    <main class="main">
        <header class="header">
            <h2 id="view-title">Dashboard</h2>
            <div id="u-badge" style="width: 40px; height: 40px; background: var(--primary); color: white; border-radius: 12px; display: flex; align-items: center; justify-content: center; font-weight: bold;">?</div>
        </header>

        <div class="content">
            <div id="view-dashboard" class="page-view">
                <div class="card" style="background: var(--primary-light); border: none;">
                    <h3>Hallo, <span id="u-name-display">...</span>!</h3>
                    <p>Willkommen zurÃ¼ck. Deine Daten sind lokal gespeichert.</p>
                </div>
                <div class="card">
                    <h3>Notizen</h3>
                    <textarea id="note-field" style="height: 150px;" oninput="syncDB()" placeholder="Deine Gedanken..."></textarea>
                </div>
            </div>

            <div id="view-classes" class="page-view hidden">
                <div class="card">
                    <button onclick="addClass()">+ Neue Klasse</button>
                    <div id="class-list" style="margin-top: 20px;"></div>
                </div>
            </div>

            <div id="view-tools" class="page-view hidden">
                <div class="card">
                    <h3>Timer</h3>
                    <div id="timer-display" style="font-size: 3rem; font-weight: bold; text-align: center; padding: 20px;">25:00</div>
                    <div style="display: flex; gap: 10px;">
                        <button onclick="startTimer(25)" style="flex: 1;">Start (25m)</button>
                        <button onclick="resetTimer()" style="background: var(--text-muted);">Reset</button>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <script>
        let state = { user: '', pass: '', notes: '', classes: [] };

        window.onload = () => {
            const stored = localStorage.getItem('tp_fixed_v45');
            if(stored) document.getElementById('reg-box').classList.add('hidden');
        };

        function handleAuth() {
            const stored = localStorage.getItem('tp_fixed_v45');
            const pass = document.getElementById('auth-pass').value;
            if(!stored) {
                const name = document.getElementById('reg-name').value;
                if(!name || !pass) return;
                state.user = name; state.pass = pass;
                syncDB(); location.reload();
            } else {
                state = JSON.parse(stored);
                if(pass === state.pass) {
                    document.getElementById('auth-overlay').classList.add('hidden');
                    init();
                } else alert("Falsch!");
            }
        }

        function init() {
            document.getElementById('u-name-display').innerText = state.user;
            document.getElementById('u-badge').innerText = state.user[0].toUpperCase();
            document.getElementById('note-field').value = state.notes;
            renderClasses();
        }

        // NAV ENGINE FIXED
        function nav(viewId) {
            // Alle Seiten verstecken
            document.querySelectorAll('.page-view').forEach(p => p.classList.add('hidden'));
            // GewÃ¼nschte Seite zeigen
            document.getElementById('view-' + viewId).classList.remove('hidden');
            
            // Nav-Buttons Stylen
            document.querySelectorAll('.nav-item').forEach(i => i.classList.remove('active'));
            event.currentTarget.classList.add('active');
            
            // Titel Ã¤ndern
            document.getElementById('view-title').innerText = viewId.charAt(0).toUpperCase() + viewId.slice(1);
        }

        function syncDB() {
            state.notes = document.getElementById('note-field').value;
            localStorage.setItem('tp_fixed_v45', JSON.stringify(state));
        }

        function addClass() {
            const n = prompt("Name:");
            if(n) { state.classes.push(n); syncDB(); renderClasses(); }
        }

        function renderClasses() {
            const l = document.getElementById('class-list');
            l.innerHTML = '';
            state.classes.forEach(c => l.innerHTML += `<div class="card" style="padding: 15px; margin-bottom: 10px;"><b>${c}</b></div>`);
        }

        let t;
        function startTimer(m) {
            clearInterval(t);
            let s = m * 60;
            t = setInterval(() => {
                s--;
                let min = Math.floor(s/60), sec = s%60;
                document.getElementById('timer-display').innerText = `${min}:${sec<10?'0':''}${sec}`;
                if(s<=0) clearInterval(t);
            }, 1000);
        }
        function resetTimer() { clearInterval(t); document.getElementById('timer-display').innerText = "25:00"; }
        function toggleTheme() { document.body.classList.toggle('dark-theme'); }
    </script>
</body>
</html>
